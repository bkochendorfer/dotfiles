#!/bin/bash

#
# Generate a unique file with common functions
# In different languages
# Open with default editor
#

modify_and_open(){
  touch $FILE
  chmod +x $FILE
  $EDITOR $FILE > /dev/tty
}

help(){
  cat <<HELP
Use this script to generate a time stamped
scratch file with common functions in a supported
language of your choice.

Currently supported languages are:
   Bash
   Ruby
   NodeJS

HELP
exit 0
}

DATE=`date +%Y.%m.%d_%H.%M`
FILE="scratch-$DATE"

#
# Read in the lang choice 
# create file type
#

case "$1" in
  'ruby')
    FILE="$FILE.rb"
    touch $FILE
    cat << 'EOF' > $FILE
#!/usr/bin/env ruby

#
# Generated by scratch
#

# class bar
# end

# bar.new
EOF
    modify_and_open
    ;;
  'node')
    FILE="$FILE.js"
    touch $FILE
    cat << 'EOF' > $FILE
#!/usr/bin/env node

//
// Generated by scratch
//

// var path = require('path');
// var spawn = require('child_process').spawn;
// var fs = require('fs');
// var http = require('http');

// var options = {
//   host: 'www.groupon.com',
//   path: '/deals'
//  };

//  callback = function(response) {
//    var str = '';

//   response.on('data', function (chunk) {
//     str += chunk;
//   });

//   response.on('end', function () {
//     console.log(str);
//   });
// }

// http.request(options, callback).end();

EOF
    modify_and_open
    ;;
  'bash')
    FILE="$FILE.sh"
    touch $FILE
    cat << 'EOF' > $FILE
#!/bin/bash

#
# Generated by scratch
#

#
# Verbose output
#

# set -exv

#
# Common functions
#

# if [[ condition ]]; then
#  statements
# fi

# for i in {1..100}; do
#   statements
# done

# OPTIND=1

# while getopts "" opt; do
#   case "$opt" in
#   esac
# done

#
# Common variables
#

# DATE=`date +%Y.%m.%d_%H.%M`
# DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

#
# Common logger
#

# exec > >(tee -a $DIR/../log/$DATE.log) 2>&1
EOF
    modify_and_open
    ;;
  *)
    help
    ;;
esac
